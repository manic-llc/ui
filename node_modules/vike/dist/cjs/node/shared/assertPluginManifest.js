"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.assertPluginManifest = assertPluginManifest;
const assertRuntimeManifest_js_1 = require("./assertRuntimeManifest.js");
const utils_js_1 = require("./utils.js");
function assertPluginManifest(pluginManifest) {
    (0, utils_js_1.assert)((0, utils_js_1.isPlainObject)(pluginManifest));
    (0, utils_js_1.assertUsage)(pluginManifest.version === utils_js_1.projectInfo.projectVersion, `Re-build your app (you're using vike@${utils_js_1.projectInfo.projectVersion} but your app was built with vike@${pluginManifest.version})`);
    (0, assertRuntimeManifest_js_1.assertRuntimeManifest)(pluginManifest);
    (0, utils_js_1.assert)((0, utils_js_1.hasProp)(pluginManifest, 'usesClientRouter', 'boolean'));
    (0, utils_js_1.assert)((0, utils_js_1.hasProp)(pluginManifest, 'version', 'string'));
    // Avoid:
    // ```
    // Uncaught (in promise) TypeError: Cannot set property manifestKeyMap of #<Object> which has only a getter
    // ```
    // We removed manifestKeyMap, maybe this isn't needed anymore.
    // See https://github.com/vikejs/vike/issues/596
    const pluginManifestClone = { ...pluginManifest };
    (0, utils_js_1.checkType)(pluginManifestClone);
}
