"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.loadImportBuild = loadImportBuild;
exports.setImportBuildGetters = setImportBuildGetters;
const runtime_1 = require("@brillout/vite-plugin-server-entry/runtime");
const utils_js_1 = require("../utils.js");
const buildGetters = (globalThis.__vike_buildGetters = globalThis.__vike_buildGetters || {
    getters: null
});
function setImportBuildGetters(getters) {
    buildGetters.getters = getters;
}
async function loadImportBuild(outDir) {
    if (!buildGetters.getters) {
        await (0, runtime_1.importServerProductionEntry)({ outDir });
        (0, utils_js_1.assert)(buildGetters.getters);
    }
    const [pageFiles, assetsManifest, pluginManifest] = await Promise.all([
        buildGetters.getters.pageFiles(),
        buildGetters.getters.getAssetsManifest(),
        buildGetters.getters.pluginManifest()
    ]);
    const buildEntries = { pageFiles, assetsManifest, pluginManifest };
    return buildEntries;
}
