"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.assertVikeConfig = assertVikeConfig;
const utils_js_1 = require("../../utils.js");
function assertVikeConfig(vikeConfig, wrongUsageMsg) {
    const wrongUsageError = checkConfigVike(vikeConfig);
    if (wrongUsageError) {
        (0, utils_js_1.assertUsage)(false, wrongUsageMsg(wrongUsageError));
    }
}
function checkConfigVike(configVike) {
    (0, utils_js_1.assert)((0, utils_js_1.isObject)(configVike));
    {
        const prop = 'disableUrlNormalization';
        if (!(0, utils_js_1.hasProp)(configVike, prop, 'boolean') && !(0, utils_js_1.hasProp)(configVike, prop, 'undefined'))
            return { prop, errMsg: 'should be a boolean' };
    }
    {
        const prop = 'trailingSlash';
        if (!(0, utils_js_1.hasProp)(configVike, prop, 'boolean') && !(0, utils_js_1.hasProp)(configVike, prop, 'undefined'))
            return { prop, errMsg: 'should be a boolean' };
    }
    {
        const prop = 'redirects';
        const { redirects } = configVike;
        if (!(redirects === undefined ||
            ((0, utils_js_1.isObject)(redirects) && Object.values(redirects).every((v) => typeof v === 'string'))))
            return { prop, errMsg: 'should be an object of strings' };
    }
    {
        const prop = 'disableAutoFullBuild';
        if (!(0, utils_js_1.hasProp)(configVike, prop, 'boolean') &&
            !(0, utils_js_1.hasProp)(configVike, prop, 'undefined') &&
            !(configVike[prop] === 'prerender'))
            return { prop, errMsg: "should be a boolean or 'prerender'" };
    }
    {
        const prop = 'includeAssetsImportedByServer';
        if (!(0, utils_js_1.hasProp)(configVike, prop, 'boolean') && !(0, utils_js_1.hasProp)(configVike, prop, 'undefined'))
            return { prop, errMsg: 'should be a boolean' };
    }
    {
        const prop = 'prerender';
        if (!(0, utils_js_1.hasProp)(configVike, prop, 'object') &&
            !(0, utils_js_1.hasProp)(configVike, prop, 'boolean') &&
            !(0, utils_js_1.hasProp)(configVike, prop, 'undefined'))
            return { prop, errMsg: 'should be an object or a boolean' };
    }
    const configVikePrerender = configVike.prerender;
    if (typeof configVikePrerender === 'object') {
        {
            const p = 'partial';
            if (!(0, utils_js_1.hasProp)(configVikePrerender, p, 'boolean') && !(0, utils_js_1.hasProp)(configVikePrerender, p, 'undefined'))
                return { prop: `prerender.${p}`, errMsg: 'should be a boolean' };
        }
        {
            const p = 'noExtraDir';
            if (!(0, utils_js_1.hasProp)(configVikePrerender, p, 'boolean') && !(0, utils_js_1.hasProp)(configVikePrerender, p, 'undefined'))
                return { prop: `prerender.${p}`, errMsg: 'should be a boolean' };
        }
        {
            const p = 'disableAutoRun';
            if (!(0, utils_js_1.hasProp)(configVikePrerender, p, 'boolean') && !(0, utils_js_1.hasProp)(configVikePrerender, p, 'undefined'))
                return { prop: `prerender.${p}`, errMsg: 'should be a boolean' };
        }
        {
            const p = 'parallel';
            if (!(0, utils_js_1.hasProp)(configVikePrerender, p, 'boolean') &&
                !(0, utils_js_1.hasProp)(configVikePrerender, p, 'number') &&
                !(0, utils_js_1.hasProp)(configVikePrerender, p, 'undefined'))
                return { prop: `prerender.${p}`, errMsg: 'should be a boolean or a number' };
        }
    }
    return null;
}
